# ZXY的README

这个暑假我和zzx共同完成了一个视频播放APP的开发，我负责的模块有module_discover和module_rankings模块的开发，接下来我来讲解有关这两个模块的详细技术实现。

## 技术栈

采用MVVM架构

paging3 + flow实现下滑加载更多

paging的LoadStateAdapter处理加载状态

Retrofit + flow进行网络请求，用stateflow代替LiveData

Coroutine非阻塞式代码

Retrofit + Rxjava + LiveData网络请求

简单的属性动画

## 界面设计

### module_discover

**这个模块主要是实现了对于视频的分类以及视频主题的划分。**

#### 整体

整体上使用的是RV嵌套RV，本来看模块比较少使用的是ScrollView，但是发现没法上滑时没法与底部导航栏进行联动，故改为RV

#### 热门分类

![分类界面](C:\Users\zxy13\Desktop\zxy_README\分类界面.gif)



首先分类使用就是rv，把layoutManager设成GridLayoutManager写了个渐变的shape当背景，接口上有几个分类本来是没有的，但是为了美观还是本地添加了上去，所以传入的id可能是别的分类的（就一两个没有），点进去后用了一个协调者布局，折叠上去后将类别设置为Toolbar上的字，头图片接口也失效了，所以本地传了一张比较泛的图片，以保证界面的整体美观，item的无限滑动使用的是page3来进行无限加载

#### 推荐主题

![推荐主题](C:\Users\zxy13\Desktop\zxy_README\推荐主题.gif)

推荐页面的实现就是RV，然后做了一个共同元素的动画跳转效果，但是在初次实现时有时会因为加载不及时而导致动画畸变，所以后来加了个50ms的延时以防止这种情况的发生。

### module_rankings

#### 整体

整体上使用的是ViewPager2来实现两个页面的滑动，重写了ConstraintLayout来解决界面滑动的冲突。

#### 排行

![热门界面](C:\Users\zxy13\Desktop\zxy_README\热门界面.gif)

排行我仿照官方的开眼，实现了当切换到排行页面时自动将第一个item升级到videoItem来实现自动播放的效果，当滑动到视频完全消失则降级为普通item，如果没有重启应用则不再播放的效果，使用的谷歌的exoplayer来实现播放的效果。（当初在写的时候当滑动到另一个排行或者下滑消失时因为没有暂停或者清除及时导致经常视频不见了而声音还在）然后就是实现了月排行和总排行滑动的动画效果

## 不足

在使用mvvm的过程中逻辑处理放在view当中，显得框架有点四不像，代码也比较臃肿。

## 心得体会

不知不觉学安卓也学了一年了，当初那个连helloworld都运行不出的我今天也能使用git和模块化开发实现一个视频项目，在这一个月的考核中，因为没有在寝室写，所以效率提升了不少，学到了很多的知识，使用到了许多之前没有使用到过的技术，但是对于技术的运用依旧不熟练，且不说没有到源码的阶段，连灵活运用都还有点问题，例如协程，retrofit这些优秀的技术仅仅在项目中特定的地方用到。最后也很感谢红岩一年以来的技术支持，以及学长的悉心教导。

